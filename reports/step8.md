# Step8 Report

## 2018011423 任一

### 实验内容

在本次实验中，我完整阅读并学习了实验参考书中的内容，并且加入了循环语句的内容。具体来说，我修改了`.g4`文件，加入了各类循环语句的内容，完善了语法。在`IRGenerator.py`中，我加入了有关循环语句的Visitor，各类循环语句都被我划归为了一个等价类，以便统一生成循环相关的跳转语句。对于`break`和`continue` 是否在循环语句块内，我维护了2个列表，分别存放循环开始的label和循环结束的label，方便`continue`和`break`使用，在每次循环进入或退出的时候都对这个列表进行修改。在调用`break`和`continue`时如果这个列表为空，则说明`break`和`continue`语句在循环外，需要报错并终止程序。



### 思考题

1. Q: [step8](https://decaf-lang.github.io/minidecaf-tutorial/docs/lab8/guide.html)中翻译`while`循环的两种方式从执行指令条数的角度来看，哪种更好？

   A: 设循环只执行了一次。在第一种方法中，需要执行的语句有`cond`, `beqz`, `body`, `br`, `cond`, `beqz`共6部分.第二种方法中，需要执行的语句有`cond`, `beqz`, `body`, `cond`, `bnez`共5部分. 因此从执行指令条数的角度来看，第二种更好。第二种较第一种，少了一次`br`的跳转。

   

### 复用代码情况

本次实验中，我主要参考了助教的`for`语句的通用`loop`函数，以及检测`break`, `continue`是否在循环语句内的实现。在参考前，我也进行了仔细的学习和理解，并在关键处加入了充足的注释以帮助自己理解和学习。

