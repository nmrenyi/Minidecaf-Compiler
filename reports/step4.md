# Step4 Report

## 2018011423 任一

### 实验内容

在本次实验中，我完整阅读并学习了实验参考书中的内容，并且加入了有关逻辑表达式的内容，使我的编译器成功通过了STEP4。主要进行的改动是，根据实验指导书，在`.g4`文件中加入了有关逻辑或、逻辑与的代码，并且在`IRGenerator.py`中加入了与、或等操作的visitor函数。此外，在生成汇编代码时，对逻辑与和逻辑或，我使用了实验指导书上的提供的汇编代码。对于`>=`操作，我使用了对`<`和`!`结果叠加的结果，`<=`操作同理。



### 思考题

1. Q: 在表达式计算时，对于某一步运算，是否一定要先计算出所有的操作数的结果才能进行运算？

   A: **不是**。例如在表达式`(1+2)/cost_time()`中，`cost_time()`是一个返回`int`的很耗时的函数，根据运算优先级，该表达式会先计算`(1+2)`并且放入栈中，`cost_time()`返回后才会进行除法。此外，例如表达式`1 || boolFunc()`，其中`boolFunc()`是一个返回值类型为`bool`的函数，由于短路求值特性，`boolFunc()`不会被调用，该表达式直接返回1.

   
   
2. Q: 为何短路求值这一特性广受欢迎？你认为短路求值这一特性会给程序员带来怎样的好处？

   A:  在逻辑表达式的判断中，短路求值能够简化编程，减小程序员的负担。

   ​	例如在下面的C代码中，短路求值就发挥了作用

   ```c
   #define MAX_LENGTH = 10
   int a[MAX_LENGTH];
   void func(int i) {
   	if (i >= 0 && i < MAX_LENGTH && a[i] > 0) {
   		doSomething(a[i]);
   	}
   }
   ```

   在`func()`函数的`if`语句中，会先对`i`的值做检查，检查是否越界，然后再判断`a[i]`是否是正数，如果`i`的值越界了，`a[i] > 0`这个检查就不会进行，从而在一定程度上简化了编程逻辑、减少了一些出错的可能。

   

### 复用代码情况

在本次实验中，我主要按照实验指导书进行了操作，对样例代码没有直接的参考。
