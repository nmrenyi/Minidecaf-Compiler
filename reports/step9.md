# Step9 Report

## 2018011423 任一

### 实验内容

在本次实验中，我完整阅读并学习了实验参考书中的内容，并且加入了函数声明、定义和调用的内容。具体来说，我修改了`.g4`文件，加入了函数的声明、定义、调用的内容，完善了语法。我也加入了有关函数调用名称表的相关内容，并且修改名词解析的过程，使之与函数调用相适应。此外，我也加入了函数参数的非标准调用规定，并且在函数的`prologue`当中把参数从 caller 的栈帧复制到 callee 的栈帧。总的来说Step9任务量较大。



### 思考题

1. Q: MiniDecaf 的函数调用时参数求值的顺序是未定义行为。试写出一段 MiniDecaf 代码，使得不同的参数求值顺序会导致不同的返回结果。

   A: 这段代码的返回值是0

   ```c
   int func(int a, int b) {
       return a - b;
   }
   
   int main() {
       int a = 0;
       return func(a, a = 1);
   }
   
   ```
   
   更改了参数求值顺序，这段代码的返回值是1
   
   ```c
   int func(int a, int b) {
       return a - b;
   }
   
   int main() {
       int a = 0;
       return func(a = 1, a);
   }
   ```
   
   

### 复用代码情况

本次实验中，我主要参考了助教的函数调用的Visitor写法，并且仿照了函数名称表的结构。参考了上述内容后，我也认真学习和理解了助教的参考实现，并在自己的代码中加入了较为详细的注释，以加深自己的理解。
